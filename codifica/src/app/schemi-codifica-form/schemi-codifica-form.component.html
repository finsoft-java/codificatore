        <div>
            <h2 class="first-section-header">Dati Iniziali</h2>
            <form class="schema-form">
                <mat-form-field appearance="fill">
                    <mat-label>Titolo</mat-label>
                    <input  [(ngModel)]="schemaCodificaForm.TITOLO" name="TITOLO" type="text" matInput>
                </mat-form-field>
                <mat-radio-group
                aria-labelledby="Tipologia Schema"
                [(ngModel)]="schemaCodificaForm.TIPOLOGIA"
                name="TIPOLOGIA">
                    <label class="schema-type-label">Tipologia di Schema</label>
                    <mat-radio-button value="P">
                        Pubblico
                    </mat-radio-button>
                    <mat-radio-button value="I">
                        Interno
                    </mat-radio-button>
                </mat-radio-group>
                <label class="rule-label">Schema valido</label>
                <mat-checkbox [checked]="schemaCodificaForm.IS_VALID==='Y'" (change)="onChangeValid($event)" class="variable-required"></mat-checkbox>
                <mat-form-field appearance="fill">
                    <mat-label>Descrizione</mat-label>
                    <textarea [(ngModel)]="schemaCodificaForm.DESCRIZIONE" name="DESCRIZIONE" matInput class="text-area-lg"></textarea>
                    <mat-hint>Apparir√† all'utente come "hint".</mat-hint>
                </mat-form-field>
                <mat-form-field appearance="fill">
                    <mat-label>Template Codice</mat-label>
                    <textarea matInput [(ngModel)]="schemaCodificaForm.TPL_CODICE" name="TPL_CODICE" class="text-area-sm"></textarea>
                    <mat-hint ngNonBindable>Tipicamente {{costruttore.toUppercase()}} - {{nparte}}</mat-hint>
                </mat-form-field>
                <mat-form-field appearance="fill">
                    <mat-label>Template Descrizione</mat-label>
                    <textarea matInput [(ngModel)]="schemaCodificaForm.TPL_DESCRIZIONE" name="TPL_DESCRIZIONE" class="text-area-lg"></textarea>
                    <mat-hint ngNonBindable>Es. Cilindro {{tipo_prod}} - {{tipo_eff}} - alesaggio {{alesaggio}} - corsa {{corsa}} - {{ril_pos}} - {{tipo_stelo}} - {{ammort}}</mat-hint>
                </mat-form-field>
                <mat-form-field appearance="fill">
                    <mat-label>Note interne</mat-label>
                    <textarea matInput [(ngModel)]="schemaCodificaForm.NOTE_INTERNE" name="NOTE_INTERNE" class="text-area-lg"></textarea>
                    <mat-hint>Non appariranno all'utente.</mat-hint>
                </mat-form-field>
                <mat-form-field appearance="fill">
                    <mat-label>Javascript Prerender</mat-label>
                    <textarea matInput [(ngModel)]="schemaCodificaForm.PRE_RENDER_JS" name="PRE_RENDER_JS" class="text-area-lg"></textarea>
                    <mat-hint>Questa funzione JavaScript permette di alterare il comportamento standard della codifica</mat-hint>
                </mat-form-field>
            </form> 
        </div>
        <button mat-raised-button color="primary" class="spaced-button left-margin-9" (click)="id ? updateSchema() : addSchema()">{{this.id ? 'Aggiorna Schema' : 'Crea Schema'}}</button>

<!-- ============================================================================================== -->

        <div *ngIf="this.id" class="second-section">
            <h2 class="rules-header">Regole di Codifica</h2>
            <button *ngIf="!this.newRuleFormOpened" mat-raised-button color="primary" class="open-rule-form" (click)="openNewRuleForm()">Aggiungi Regola</button>
            <div *ngIf="this.newRuleFormOpened" style="margin: 20px 0 0 2px">
                <h5 style="display: inline-block;">Nuova Regola</h5>
                <button (click)="this.newRuleFormOpened=!this.newRuleFormOpened " class="clear-button close-form"><mat-icon class="mat-icon">clear</mat-icon></button>
                <app-schemi-codifica-regola [regola]="nuovaRegola" [creating]="true" (saved)="refreshRegole()" (deleted)="refreshRegole()" ></app-schemi-codifica-regola>
            </div>
            <mat-accordion>
                <mat-expansion-panel *ngFor="let schemaRule of schemaCodificaRegole2">
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            {{schemaRule.NOM_VARIABILE}}
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <app-schemi-codifica-regola [regola]="schemaRule"></app-schemi-codifica-regola>
                </mat-expansion-panel>
            </mat-accordion>       
        </div>

<!-- ============================================================================================== -->

        <div *ngIf="this.id" class="second-section">
            <button (click)="fileInput.click()" mat-raised-button color="primary" disabled>
                <span>Carica un'immagine...</span>
                <input #fileInput type="file" (change)="uploadImage($event)" accept="image/*" style="display:none;" />
            </button>
            &nbsp;
            <button mat-raised-button color="warn" (click)="deleteImage()" style="margin-right:15px;" disabled>Elimina immagine attuale</button>
        </div>